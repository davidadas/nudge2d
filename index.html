<!DOCTYPE html>
<html>
    <head>
        <script type="text/javascript" src="http://code.createjs.com/createjs-2013.12.12.min.js"></script>
        <script type="text/javascript" src="http://code.createjs.com/preloadjs-0.4.1.min.js"></script>

        <script type="text/javascript" src="./src/SpriteFactory.js"></script>
        <link href="css/styles.css" rel="stylesheet" type="text/css">

        <script>

            var canvas, stage;   // References to drawable container.
            var stageH = 640;
            var stageW = 480;
            var keepAspectRatio = true;

            var spriteBuilder;
            var loader;
            window.onresize = scaleCanvas;

            function initGame(){
                canvas = document.getElementById("gameView");
                stage = new createjs.Stage(canvas);
                scaleCanvas();
                // load game resources into the manifest.
                var manifest = [
                    {src:"images/units/grunt.png",  id:"grunt"},
                    {src:"images/units/titan.png",  id:"titan"},
                    {src:"images/units/walker.png", id:"walker"}
                ];

                loader = new createjs.LoadQueue(false);
                loader.addEventListener("complete", function(){
                    spriteBuilder = new SpriteFactory(loader);
                });
                createjs.Ticker.addEventListener("tick", tickStage);
                loader.loadManifest(manifest);
            }

            function tickStage(event){
                // update the view.
                stage.update(event);
            }

            function scaleCanvas() {
                // the following borrowed from: http://bit.ly/11b5Pij
                var w = window.innerWidth;
                var h = window.innerHeight;

                if (keepAspectRatio) {
                    // keep aspect ratio
                    var scale = Math.min(w / stageW, h / stageH);
                    stage.scaleX = scale;
                    stage.scaleY = scale;

                    // adjust canvas size
                    stage.canvas.width = stageW * scale;
                    stage.canvas.height = stageH * scale;
                } else {
                    // scale to exact fit
                    stage.scaleX = w / stageH;
                    stage.scaleY = h / stageH;

                    // adjust canvas size
                    stage.canvas.width = stageH * stage.scaleX;
                    stage.canvas.height = stageH * stage.scaleY;
                }

                // update the stage
                stage.update()
            }
        </script>
    </head>
    <body onLoad="initGame();">
        <canvas id="gameView"></canvas>
    </body>
</html>